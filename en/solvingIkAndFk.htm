<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Strict//EN">
<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<title>Solving IK and FK</title>
<link rel="stylesheet" type="text/css" href="../style.css">
</head>

<body>

<div align="center">
<table class=allEncompassingTable >
 <tr>
  <td >
<p><a href="../index.html" TARGET="_top"><img src="images/homeImg.png"></a></p>



<h1>Solving IK and FK Tasks</h1>

<p>CoppeliaSim uses <em>IK groups</em> and <em>IK elements</em> to solve inverse and forward kinematics tasks. It is important to understand how an IK task is solved in order to take full advantage of the kinematics functionality CoppeliaSim offers. Several example scenes related to IK and FK can also be found in  <em>scenes/kinematics</em>. </p>
<p>An IK task is defined by an IK group, which contains one or more IK elements:<br>
</p>

<li><strong>IK element</strong>: an IK element represents a simple kinematic chain, which is a linkage containing at least one joint. The chain is specified by a  base, a tip indicating the end-effector, and a target for the tip to follow. An IK element describes a <em>naked</em> Jacobian, where the rows represent the constraints, and the columns represent the degrees of freedom. In short, an IK element is made up by:<br>
</li>

<li class=tabTab>a base, which represents the start of the kinematic chain<br>
</li>

<li class=tabTab>several links (any type of object except joints). Joints which are <em>passive</em> are however also considered as links (in that case they behave as rigid joints (joints with a fixed linear/angular position))</li>

<li class=tabTab>several joints</li>

<li class=tabTab>a tip, which is usually the last object in the considered kinematic chain (when going from base to tip), and is often the end-effector. The tip object should be linked to a target object (see hereafter)</li>

<li class=tabTab>a target representing the desired tip position and/or orientation. The target object should be linked to a tip object (see hereabove)</li>

<li><strong>IK group</strong>: an IK group contains one or more IK elements. To solve the kinematics of a simple kinematic chain, one IK group containing one IK element is needed. The IK group defines the overall solving properties (such as the  solver, the number of iterations, etc.). An IK group describes the Jacobian obtained by horizontalling stacking the Jacobians from its IK elements.<br>
</li>




<p>Following figures show two kinematic chains as they are described via IK elements. The two IK elements perceive the two chains in a similar way (the very first joint of the second example is ignored by the IK element):<br>
</p>


<p align=center><img src="images/ikBasics1.jpg"></p>
<p class=imageLabel>[Two kinematic chains, each describing an IK element]</p>
<br>


<p>The goal of an IK element  (i.e. resolution of an IK element) is to have the target followed by the tip (i.e. having tip and target overlap, given certain constraints and tolerances), by computing the appropriate joint values for the kinematic chain:<br>
</p>
<p align=center><img src="images/ikBasics2.jpg"></p>
<p class=imageLabel>[IK element and corresponding model of the IK solving task]</p>
<br>

<p>In above example (in 2D for simplicity), we can specify various constraints for the tip-target pair, e.g.:</p>
<li> <strong>X positional constraint</strong>: the tip would follow the target only on the X-axis, and the kinematic chain would appear redundant for this task since the chain itself has 3 degrees of freedom.</li>
<li> <strong>X/Y positional constraints</strong>: the tip would follow the target only in position, and the kinematic chain would still appear redundant for this task.</li>
<li> <strong>X/Y positional + &Theta; orientational constraints</strong>: the tip would follow the target in position and orientation, and the kinematic chain would not appear as redundant anymore for this task.</li>
<p>Note that even for the most basic IK task, an IK element is solved via the resolution of the encompassing  IK group.</p>
<p>Two separate kinematic chains are handled in an identical fashion, however this time, two IK groups are needed (and each one of them should contain one IK element for each kinematic chain). Solving order of the two IK groups is not relevant, when both tasks are distinct:<br>
</p>
<p align=center><img src="images/ikBasics3.jpg"></p>
<p class=imageLabel>[Two separate IK chains and corresponding model of the IK solving tasks]</p>
<br>

<p>In above example, should<em> target2</em> be attached to a mobile part of the first kinematic chain, then the solving order becomes relevant and  <em>IK group1</em> should be solved first (solving result will displace <em>target2</em> as can be seen from following figure):<br>
</p>


<p align=center><img src="images/ikBasics4.jpg"></p>
<p class=imageLabel>[Two separate IK chains, where the target of the second chain is attached to the first chain, and corresponding model of the IK solving tasks]</p>
<br>

<p>A similar case can appear when one IK element is built on top of another IK element, without sharing any common joint as can be seen from following figure: the first kinematic chain is indicated in black, the second in light blue. <em>Base2</em>, indicated in purple, is the common object between the two chains. Solving  <em>IK element2</em> won't displace the purple link, however solving <em>IK element1</em> will displace it. For that reason <em> IK group1</em> has to be solved before <em>IK group2</em> as in above case (solving order is important):<br>
</p>


<p align=center><img src="images/ikBasics5.jpg"></p>
<p class=imageLabel>[Two IK chains sharing one common link but no common joints and corresponding model of the IK solving tasks]</p>
<br>

<p>A more difficult case appears when two or more kinematic chains share common joints. In that case sequential solving doesn't work most of the time (in following example, the two IK elements tend to rotate the common joint into opposite directions) and a simultaneous solving method is needed. To simultaneously solve several IK elements, just group them into one common IK group. This case is illustrated in following figure:<br>
</p>


<p align=center><img src="images/ikBasics6.jpg"></p>
<p class=imageLabel>[Two IK chains sharing one common joint and corresponding model of the IK solving task]</p>
<br>


<p> Positional constraints are specified by default relative to the base's reference frame as can be seen from following figure:</p>

<p align=center><img src="images/ikSolving1.jpg"></p>
<p class=imageLabel>[Positional constraints for a kinematic chain]</p>
<br>


<p>It is however possible to select any reference frame for the positional constraints. Orientational contraints can be full (alpha-beta-gamma, with 3DoFs), partial 3D (alpha-beta, with 2DoFs, where only the z-axes of tip and target are overlapping), partial 2D (gamma, with 1DoF), or turned off completely.</p>

<p>Always verify that individual IK Elements are not overconstrained, in order to avoid a strange behaviour. If this cannot be avoided, or when operating close to a singularity, selecting a damped resolution method often helps (but will always slow down calculations).</p>

<p>It is also possible to simultaneously solve IK elements while respecting a prioritization hierarchy (via the null-space projection method), or to link two or several joints via dependency constraints, in order to achieve a complex behaviour.</p>

<br>
<br>
 </tr>
</table> 
</div>  
  
  
</body>

</html>
